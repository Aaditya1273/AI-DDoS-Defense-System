<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberShield DDoS Defense</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&family=Inter:wght@300;400;500;600;700&display=swap');
        
        :root {
            --primary: #23C8FF;
            --primary-dark: #15A1D9;
            --secondary: #FFB629;
            --tertiary: #FF4081;
            --success: #1CEFAF;
            --warning: #F5C346;
            --danger: #FF5252;
            --dark: #111A2C;
            --darker: #0A0E1A;
            --light-dark: #1E293B;
            --border: #2B3A55;
            --text: #E2E8F0;
            --text-muted: #94A3B8;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--darker);
            color: var(--text);
            overflow-x: hidden;
        }
        
        .font-mono {
            font-family: 'IBM Plex Mono', monospace;
        }
        
        .neo-card {
            background-color: var(--dark);
            border: 1px solid var(--border);
            border-radius: 1rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
        }
        
        .neo-card-header {
            border-bottom: 1px solid var(--border);
            padding-bottom: 0.75rem;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .neo-card-title {
            font-weight: 600;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .neo-bg-gradient {
            background: linear-gradient(135deg, var(--dark) 0%, var(--darker) 100%);
        }
        
        .neo-status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 2rem;
            font-size: 0.75rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        
        .neo-status-badge.active {
            background-color: rgba(28, 239, 175, 0.15);
            color: var(--success);
            border: 1px solid rgba(28, 239, 175, 0.3);
        }
        
        .neo-status-badge.warning {
            background-color: rgba(245, 195, 70, 0.15);
            color: var(--warning);
            border: 1px solid rgba(245, 195, 70, 0.3);
        }
        
        .neo-status-badge.danger {
            background-color: rgba(255, 82, 82, 0.15);
            color: var(--danger);
            border: 1px solid rgba(255, 82, 82, 0.3);
        }
        
        .neo-progress {
            height: 6px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .neo-progress-bar {
            height: 100%;
            border-radius: 3px;
            transition: width 0.6s ease;
        }
        
        .neo-progress-bar.primary {
            background: linear-gradient(90deg, var(--primary-dark), var(--primary));
        }
        
        .neo-progress-bar.success {
            background: linear-gradient(90deg, #0DA57F, var(--success));
        }
        
        .neo-progress-bar.warning {
            background: linear-gradient(90deg, #E5A313, var(--warning));
        }
        
        .neo-progress-bar.danger {
            background: linear-gradient(90deg, #D32F2F, var(--danger));
        }
        
        .neo-btn {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .neo-btn-primary {
            background-color: rgba(35, 200, 255, 0.15);
            color: var(--primary);
            border: 1px solid rgba(35, 200, 255, 0.3);
        }
        
        .neo-btn-primary:hover {
            background-color: rgba(35, 200, 255, 0.25);
        }
        
        .neo-btn-danger {
            background-color: rgba(255, 82, 82, 0.15);
            color: var(--danger);
            border: 1px solid rgba(255, 82, 82, 0.3);
        }
        
        .neo-btn-danger:hover {
            background-color: rgba(255, 82, 82, 0.25);
        }
        
        .neo-sidebar {
            background-color: var(--dark);
            border-right: 1px solid var(--border);
            height: 100vh;
            position: fixed;
            width: 250px;
            padding: 1.5rem 0;
            z-index: 40;
            transition: transform 0.3s ease;
        }
        
        .neo-sidebar-hidden {
            transform: translateX(-250px);
        }
        
        .neo-sidebar-link {
            padding: 0.75rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--text-muted);
            transition: all 0.2s ease;
            font-weight: 500;
        }
        
        .neo-sidebar-link:hover {
            color: var(--text);
            background-color: rgba(255, 255, 255, 0.05);
        }
        
        .neo-sidebar-link.active {
            color: var(--primary);
            background-color: rgba(35, 200, 255, 0.1);
            border-right: 3px solid var(--primary);
        }
        
        .neo-main {
            margin-left: 250px;
            padding: 1.5rem;
            transition: margin-left 0.3s ease;
            min-height: 100vh;
            position: relative;
        }
        
        .neo-main-expanded {
            margin-left: 0;
        }
        
        .neo-stat-value {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        .neo-stat-label {
            font-size: 0.875rem;
            color: var(--text-muted);
        }
        
        .neo-hexagon {
            position: relative;
            clip-path: polygon(50% 0%, 93% 25%, 93% 75%, 50% 100%, 7% 75%, 7% 25%);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .neo-metric-card {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background-color: var(--light-dark);
            border-radius: 0.75rem;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .neo-metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }
        
        .neo-data-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }
        
        .neo-data-table thead th {
            padding: 0.75rem 1rem;
            text-align: left;
            font-weight: 500;
            color: var(--text-muted);
            border-bottom: 1px solid var(--border);
        }
        
        .neo-data-table tbody td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid rgba(43, 58, 85, 0.5);
        }
        
        .neo-data-table tbody tr:last-child td {
            border-bottom: none;
        }
        
        .neo-data-table tbody tr {
            transition: background-color 0.2s ease;
        }
        
        .neo-data-table tbody tr:hover {
            background-color: rgba(255, 255, 255, 0.03);
        }
        
        .neo-header {
            position: sticky;
            top: 0;
            z-index: 30;
            background-color: var(--dark);
            border-bottom: 1px solid var(--border);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            width: 100%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .neo-alert {
            padding: 1rem;
            border-radius: 0.75rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .neo-alert-content {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .neo-alert-danger {
            background-color: rgba(255, 82, 82, 0.15);
            border: 1px solid rgba(255, 82, 82, 0.3);
        }
        
        .neo-toggle-sidebar {
            position: fixed;
            left: 250px;
            top: 1.5rem;
            width: 40px;
            height: 40px;
            background-color: var(--dark);
            border: 1px solid var(--border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            z-index: 50;
            transition: left 0.3s ease, transform 0.3s ease;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        .neo-toggle-sidebar:hover {
            color: var(--primary);
            border-color: var(--primary);
        }
        
        .neo-toggle-sidebar.collapsed {
            left: 1.5rem;
            transform: rotate(180deg);
        }
        
        /* Animation for scrolling numbers */
        @keyframes scrollNumber {
            0% { transform: translateY(0); }
            100% { transform: translateY(-100%); }
        }
        
        .number-scroll-wrapper {
            height: 1.5rem;
            overflow: hidden;
            position: relative;
        }
        
        .number-scroll {
            animation: scrollNumber 5s infinite linear;
        }
        
        .number-scroll div {
            height: 1.5rem;
            line-height: 1.5rem;
        }
        
        @media (max-width: 768px) {
            .neo-sidebar {
                transform: translateX(-250px);
            }
            
            .neo-main {
                margin-left: 0;
            }
            
            .neo-toggle-sidebar {
                left: 1.5rem;
                transform: rotate(180deg);
            }
            
            .neo-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .neo-header > div:last-child {
                width: 100%;
                justify-content: space-between;
            }
        }
        
        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }
        
        .pulse-animation {
            animation: pulse 2s infinite ease-in-out;
        }
    </style>
</head>
<body>
    <!-- Toggle Sidebar Button -->
    <div id="sidebar-toggle" class="neo-toggle-sidebar">
        <i class="fas fa-angle-left"></i>
    </div>

    <!-- Sidebar Navigation -->
    <aside id="sidebar" class="neo-sidebar">
        <div class="px-6 pb-6 mb-6 border-b border-border">
            <h1 class="text-xl font-bold text-primary flex items-center gap-2">
                <i class="fas fa-shield-alt"></i>
                <span>CyberShield</span>
            </h1>
            <p class="text-sm text-text-muted mt-1">Advanced DDoS Protection</p>
        </div>
        
        <nav class="mb-6">
            <a href="#" class="neo-sidebar-link active">
                <i class="fas fa-chart-line"></i>
                <span>Dashboard</span>
            </a>
            <a href="#" class="neo-sidebar-link">
                <i class="fas fa-shield-virus"></i>
                <span>Threat Analysis</span>
            </a>
            <a href="#" class="neo-sidebar-link">
                <i class="fas fa-network-wired"></i>
                <span>Network Traffic</span>
            </a>
            <a href="#" class="neo-sidebar-link">
                <i class="fas fa-server"></i>
                <span>Infrastructure</span>
            </a>
            <a href="#" class="neo-sidebar-link">
                <i class="fas fa-user-shield"></i>
                <span>Identity Control</span>
            </a>
            <a href="#" class="neo-sidebar-link">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </a>
        </nav>
        
        <div class="px-6">
            <div class="neo-card p-4">
                <h3 class="text-sm font-medium text-text-muted mb-2">System Status</h3>
                <div class="flex items-center gap-2">
                    <div class="w-3 h-3 rounded-full bg-success"></div>
                    <span class="text-success font-medium">Protected</span>
                </div>
                <div class="text-xs text-text-muted mt-2">
                    Last scan: <span id="last-scan-time">3 minutes ago</span>
                </div>
            </div>
        </div>
    </aside>
    
    <!-- Main Content Area -->
    <main id="main-content" class="neo-main">
        <!-- Header -->
        <header class="neo-header flex items-center justify-between mb-6">
            <div>
                <h1 class="text-2xl font-bold text-white">Security Dashboard</h1>
                <p class="text-text-muted mt-1">Real-time DDoS monitoring and defense</p>
            </div>
            
            <div class="flex items-center gap-6">
                <div id="status-indicator" class="neo-status-badge active">
                    <div class="w-2 h-2 rounded-full bg-success"></div>
                    <span>System Protected</span>
                </div>
                
                <div class="font-mono text-sm whitespace-nowrap" id="packet-counter">0 packets analyzed</div>
                
                <div class="relative">
                    <button class="neo-btn neo-btn-primary">
                        <i class="fas fa-shield-alt"></i>
                        <span>Protection Status</span>
                    </button>
                </div>
            </div>
        </header>
        
        <!-- Alert Banner (Hidden by default) -->
        <div id="alertBanner" class="neo-alert neo-alert-danger hidden">
            <div class="neo-alert-content">
                <div class="w-10 h-10 rounded-full bg-danger/20 flex items-center justify-center">
                    <i class="fas fa-exclamation-triangle text-danger"></i>
                </div>
                <div>
                    <h3 class="font-semibold">DDoS Attack Detected</h3>
                    <p id="alert-details" class="text-sm text-text-muted">Mitigation protocols activated</p>
                </div>
            </div>
            <button class="text-text-muted hover:text-text">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <!-- Key Metrics Row -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
            <div class="neo-metric-card">
                <div class="w-12 h-12 neo-hexagon bg-primary/20 text-primary">
                    <i class="fas fa-chart-bar"></i>
                </div>
                <div>
                    <div id="total-packets" class="neo-stat-value text-primary">0</div>
                    <div class="neo-stat-label">Total Packets</div>
                </div>
            </div>
            
            <div class="neo-metric-card">
                <div class="w-12 h-12 neo-hexagon bg-success/20 text-success">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <div>
                    <div id="mitigation-score" class="neo-stat-value text-success">0%</div>
                    <div class="neo-stat-label">Mitigation Score</div>
                </div>
            </div>
            
            <div class="neo-metric-card">
                <div class="w-12 h-12 neo-hexagon bg-warning/20 text-warning">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <div>
                    <div id="suspicious-ips" class="neo-stat-value text-warning">0</div>
                    <div class="neo-stat-label">Suspicious IPs</div>
                </div>
            </div>
            
            <div class="neo-metric-card">
                <div class="w-12 h-12 neo-hexagon bg-danger/20 text-danger">
                    <i class="fas fa-ban"></i>
                </div>
                <div>
                    <div id="blocked-ips" class="neo-stat-value text-danger">0</div>
                    <div class="neo-stat-label">Blocked IPs</div>
                </div>
            </div>
        </div>
        
        <!-- Traffic Monitoring and System Status -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
            <!-- Traffic Visualization -->
            <div class="neo-card p-6 lg:col-span-2">
                <div class="neo-card-header">
                    <h2 class="neo-card-title">
                        <i class="fas fa-chart-area text-primary"></i>
                        Network Traffic Flow
                    </h2>
                    <div class="flex gap-2">
                        <button id="refresh-btn" class="neo-btn neo-btn-primary text-sm">
                            <i class="fas fa-sync-alt"></i>
                            <span>Refresh</span>
                        </button>
                        <button id="reset-btn" class="neo-btn neo-btn-danger text-sm">
                            <i class="fas fa-undo-alt"></i>
                            <span>Reset</span>
                        </button>
                    </div>
                </div>
                
                <div class="mb-6">
                    <div class="relative h-72">
                        <canvas id="trafficChart"></canvas>
                    </div>
                </div>
                
                <!-- Network Statistics Pills -->
                <div class="grid grid-cols-3 gap-4">
                    <div class="bg-light-dark rounded-lg p-3">
                        <div class="flex justify-between items-center mb-1">
                            <div class="text-sm text-text-muted">Packets/sec</div>
                            <div id="packets-per-sec" class="text-sm font-mono text-primary">0</div>
                        </div>
                        <div class="neo-progress">
                            <div id="packets-per-sec-bar" class="neo-progress-bar primary" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <div class="bg-light-dark rounded-lg p-3">
                        <div class="flex justify-between items-center mb-1">
                            <div class="text-sm text-text-muted">SYN Packets</div>
                            <div id="syn-packets" class="text-sm font-mono text-warning">0</div>
                        </div>
                        <div class="neo-progress">
                            <div id="syn-packets-bar" class="neo-progress-bar warning" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <div class="bg-light-dark rounded-lg p-3">
                        <div class="flex justify-between items-center mb-1">
                            <div class="text-sm text-text-muted">Throughput</div>
                            <div id="network-throughput" class="text-sm font-mono text-success">0 MB/s</div>
                        </div>
                        <div class="neo-progress">
                            <div id="network-throughput-bar" class="neo-progress-bar success" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- System Status Card -->
            <div class="neo-card p-6">
                <div class="neo-card-header">
                    <h2 class="neo-card-title">
                        <i class="fas fa-server text-primary"></i>
                        System Status
                    </h2>
                    <div class="text-xs text-text-muted">
                        <span id="system-time">00:00:00</span>
                    </div>
                </div>
                
                <div class="space-y-6">
                    <!-- CPU Usage -->
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <div class="flex items-center gap-2">
                                <div class="w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center text-primary">
                                    <i class="fas fa-microchip"></i>
                                </div>
                                <span>CPU Usage</span>
                            </div>
                            <span id="cpuUsage" class="font-mono text-primary">0%</span>
                        </div>
                        <div class="neo-progress">
                            <div id="cpuBar" class="neo-progress-bar primary" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <!-- Memory Usage -->
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <div class="flex items-center gap-2">
                                <div class="w-8 h-8 rounded-lg bg-tertiary/10 flex items-center justify-center text-tertiary">
                                    <i class="fas fa-memory"></i>
                                </div>
                                <span>Memory Usage</span>
                            </div>
                            <span id="memoryUsage" class="font-mono text-tertiary">0%</span>
                        </div>
                        <div class="neo-progress">
                            <div id="memoryBar" class="neo-progress-bar" style="width: 0%; background: linear-gradient(90deg, #C1175B, var(--tertiary));"></div>
                        </div>
                    </div>
                    
                    <!-- Network I/O -->
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <div class="flex items-center gap-2">
                                <div class="w-8 h-8 rounded-lg bg-secondary/10 flex items-center justify-center text-secondary">
                                    <i class="fas fa-network-wired"></i>
                                </div>
                                <span>Network I/O</span>
                            </div>
                            <span id="networkUsage" class="font-mono text-secondary">0 MB/s</span>
                        </div>
                        <div class="neo-progress">
                            <div id="networkBar" class="neo-progress-bar" style="width: 0%; background: linear-gradient(90deg, #D9980D, var(--secondary));"></div>
                        </div>
                    </div>
                    
                    <!-- Protection Status -->
                    <div class="bg-light-dark rounded-lg p-4">
                        <h3 class="text-sm font-medium mb-3">Protection Components</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex items-center justify-between">
                                <span>Anomaly Detection</span>
                                <span class="text-success">Active</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span>Traffic Analysis</span>
                                <span class="text-success">Active</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span>Pattern Recognition</span>
                                <span class="text-success">Active</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span>Firewall Rules</span>
                                <span id="firewall-rules" class="text-success font-mono">0 active</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Attack Monitoring and Protocol Distribution -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
            <!-- Recent Attacks -->
            <div class="neo-card p-6">
                <div class="neo-card-header">
                    <h2 class="neo-card-title">
                        <i class="fas fa-bolt text-danger"></i>
                        Attack Detection
                    </h2>
                    <div>
                        <div class="flex justify-between mb-1">
                            <span class="text-xs text-text-muted">Confidence</span>
                            <span id="confidenceValue" class="text-xs font-mono">0%</span>
                        </div>
                        <div class="neo-progress w-24">
                            <div id="confidenceBar" class="neo-progress-bar" style="width: 0%; background: linear-gradient(90deg, #D32F2F, var(--danger));"></div>
                        </div>
                    </div>
                </div>
                
                <div class="overflow-auto max-h-60">
                    <table class="neo-data-table">
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Source IP</th>
                                <th>Type</th>
                            </tr>
                        </thead>
                        <tbody id="attackTable">
                            <!-- Attack logs will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Protocol Distribution -->
            <div class="neo-card p-6">
                <div class="neo-card-header">
                    <h2 class="neo-card-title">
                        <i class="fas fa-pie-chart text-primary"></i>
                        Protocol Distribution
                    </h2>
                </div>
                
                <div class="h-64">
                    <canvas id="protocolChart"></canvas>
                </div>
                
                <div class="grid grid-cols-3 gap-4 mt-4">
                    <div class="flex flex-col items-center">
                        <div class="text-primary font-mono font-medium">TCP</div>
                        <div id="tcp-percent" class="text-sm text-text-muted">0%</div>
                    </div>
                    <div class="flex flex-col items-center">
                        <div class="text-secondary font-mono font-medium">UDP</div>
                        <div id="udp-percent" class="text-sm text-text-muted">0%</div>
                    </div>
                    <div class="flex flex-col items-center">
                        <div class="text-tertiary font-mono font-medium">ICMP</div>
                        <div id="icmp-percent" class="text-sm text-text-muted">0%</div>
                    </div>
                </div>
            </div>
            
            <!-- Top Sources -->
            <div class="neo-card p-6">
                <div class="neo-card-header">
                    <h2 class="neo-card-title">
                        <i class="fas fa-globe text-success"></i>
                        Top Source IPs
                    </h2>
                </div>
                
                <div id="top-ips" class="space-y-3">
                    <!-- Will be populated by JavaScript -->
                </div>
                
                <div class="mt-4 pt-4 border-t border-border">
                    <h3 class="text-sm font-medium mb-3">Geographic Distribution</h3>
                    <div class="h-40">
                        <canvas id="geoDistributionChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Advanced Analytics -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Packet Types -->
            <div class="neo-card p-6">
                <div class="neo-card-header">
                    <h2 class="neo-card-title">
                        <i class="fas fa-envelope text-primary"></i>
                        Packet Types
                    </h2>
                </div>
                
                <div class="h-64">
                    <canvas id="packetTypesChart"></canvas>
                </div>
            </div>
            
            <!-- Attack Distribution -->
            <div class="neo-card p-6">
                <div class="neo-card-header">
                    <h2 class="neo-card-title">
                        <i class="fas fa-bug text-danger"></i>
                        Attack Distribution
                    </h2>
                </div>
                
                <div class="h-64">
                    <canvas id="attackDistributionChart"></canvas>
                </div>
            </div>
            
            <!-- Defense Metrics -->
            <div class="neo-card p-6">
                <div class="neo-card-header">
                    <h2 class="neo-card-title">
                        <i class="fas fa-shield-alt text-success"></i>
                        Defense Metrics
                    </h2>
                </div>
                
                <div class="space-y-4">
                    <!-- Mitigation Effectiveness -->
                    <div>
                        <div class="flex justify-between items-center mb-1">
                            <span class="text-sm">Mitigation Effectiveness</span>
                            <span id="mitigationValue" class="text-sm font-mono text-success">0%</span>
                        </div>
                        <div class="neo-progress">
                            <div id="mitigationBar" class="neo-progress-bar success" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <!-- Detection Accuracy -->
                    <div>
                        <div class="flex justify-between items-center mb-1">
                            <span class="text-sm">Detection Accuracy</span>
                            <span id="detection-accuracy" class="text-sm font-mono text-primary">0%</span>
                        </div>
                        <div class="neo-progress">
                            <div id="detection-accuracy-bar" class="neo-progress-bar primary" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <!-- Response Time -->
                    <div>
                        <div class="flex justify-between items-center mb-1">
                            <span class="text-sm">Avg. Response Time</span>
                            <span id="response-time" class="text-sm font-mono text-secondary">0ms</span>
                        </div>
                        <div class="neo-progress">
                            <div id="response-time-bar" class="neo-progress-bar" style="width: 0%; background: linear-gradient(90deg, #D9980D, var(--secondary));"></div>
                        </div>
                    </div>
                    
                    <!-- Protection Status -->
                    <div class="bg-light-dark rounded-lg p-4 mt-4">
                        <h3 class="text-sm font-medium mb-3">Protection Layers</h3>
                        <div class="grid grid-cols-2 gap-3 text-sm">
                            <div class="flex items-center gap-2">
                                <div class="w-3 h-3 rounded-full bg-success"></div>
                                <span>Layer 3 (Network)</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="w-3 h-3 rounded-full bg-success"></div>
                                <span>Layer 4 (Transport)</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="w-3 h-3 rounded-full bg-success"></div>
                                <span>Layer 7 (Application)</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="w-3 h-3 rounded-full bg-success"></div>
                                <span>DNS Protection</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Connect to the Flask-SocketIO server
        const socket = io.connect('http://localhost:5000');
        
        // Variables to track data
        let totalPackets = 0;
        let attackCount = 0;
        let trafficChart;
        let lastUpdate = Date.now();
        let sidebarCollapsed = false;
        
        // Update system time
        function updateSystemTime() {
            const now = new Date();
            document.getElementById('system-time').textContent = now.toLocaleTimeString('en-US', {
                hour12: false,
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
        }
        
        // Toggle sidebar function
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('main-content');
            const toggleBtn = document.getElementById('sidebar-toggle');
            
            sidebarCollapsed = !sidebarCollapsed;
            
            if (sidebarCollapsed) {
                sidebar.classList.add('neo-sidebar-hidden');
                mainContent.classList.add('neo-main-expanded');
                toggleBtn.classList.add('collapsed');
            } else {
                sidebar.classList.remove('neo-sidebar-hidden');
                mainContent.classList.remove('neo-main-expanded');
                toggleBtn.classList.remove('collapsed');
            }
        }
        
        // Data for traffic chart
        const trafficData = {
            labels: Array(30).fill(''),
                    datasets: [
                        {
                    label: 'Total Packets',
                    data: Array(30).fill(0),
                    borderColor: 'rgba(35, 200, 255, 1)',
                    backgroundColor: 'rgba(35, 200, 255, 0.1)',
                            tension: 0.4,
                            fill: true
                        },
                        {
                    label: 'SYN Packets',
                    data: Array(30).fill(0),
                    borderColor: 'rgba(255, 65, 129, 1)',
                    backgroundColor: 'rgba(255, 65, 129, 0.1)',
                            tension: 0.4,
                            fill: true
                        }
                    ]
        };
        
        // Auto-refresh function
        function setupAutoRefresh() {
            // Auto-refresh dashboard every 5 seconds
            setInterval(function() {
                fetch('/api/stats')
                    .then(response => response.json())
                    .then(data => updateDashboard(data))
                    .catch(err => console.error('Error auto-refreshing stats:', err));
            }, 5000);
        }
        
        // Initialize everything when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Setup sidebar toggle
            document.getElementById('sidebar-toggle').addEventListener('click', toggleSidebar);
            
            // Update time initially and then every second
            updateSystemTime();
            setInterval(updateSystemTime, 1000);
            
            const ctx = document.getElementById('trafficChart').getContext('2d');
            trafficChart = new Chart(ctx, {
                type: 'line',
                data: trafficData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        }
                    },
                    animation: {
                        duration: 300
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        }
                    }
                }
            });

            // Initialize charts
            initProtocolChart();
            initPacketTypesChart();
            initAttackDistributionChart();
            initGeoDistributionChart();
            
            // Initialize attack table with sample data
            initSampleAttackData();
            
            // Update confidence for UI
            updateConfidence(65);
            
            // Try to fetch initial stats
            fetch('/api/stats')
                .then(response => response.json())
                .then(data => {
                    updateDashboard(data);
                })
                .catch(err => console.error('Error fetching initial stats:', err));
            
            // Try to fetch attack data
            fetch('/api/attacks')
                .then(response => response.json())
                .then(data => {
                    if (data && data.length > 0) {
                        data.forEach(attack => {
                            addAttackToTable(attack);
                        });
                    }
                })
                .catch(err => console.error('Error fetching attack data:', err));
            
            // Set update interval for timestamps
            setInterval(updateTimestamps, 1000);
            
            // Start auto-refresh
            setupAutoRefresh();
            
            // Handle refresh button click
            document.getElementById('refresh-btn').addEventListener('click', function() {
                fetch('/api/stats')
                    .then(response => response.json())
                    .then(data => updateDashboard(data))
                    .catch(err => console.error('Error fetching stats:', err));
            });
            
            // Handle reset button click
            document.getElementById('reset-btn').addEventListener('click', function() {
                fetch('/api/reset', {
                    method: 'POST',
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Reset stats:', data);
                    // Clear chart data
                    trafficData.datasets[0].data = Array(30).fill(0);
                    trafficData.datasets[1].data = Array(30).fill(0);
                    trafficChart.update();
                    
                    // Clear the attack table
                    const table = document.getElementById('attackTable');
                    if (table) {
                        table.innerHTML = '';
                        initSampleAttackData(); // Re-add sample data after reset
                    }
                    
                    // Reset confidence bar
                    updateConfidence(0);
                    
                    // Reset stats blocks
                    document.getElementById('suspicious-ips').textContent = '0';
                    document.getElementById('blocked-ips').textContent = '0';
                    
                    // Update UI immediately
                    setTimeout(() => {
                        fetch('/api/stats')
                            .then(response => response.json())
                            .then(data => updateDashboard(data))
                            .catch(err => console.error('Error fetching stats:', err));
                    }, 500);
                })
                .catch(err => console.error('Error resetting stats:', err));
            });
            
            // Close alert when X button is clicked
            document.querySelector('#alertBanner button').addEventListener('click', function() {
                document.getElementById('alertBanner').classList.add('hidden');
            });
        });
        
        // Matrix animation for cybersecurity aesthetic
        function initMatrix() {
            const canvas = document.getElementById('matrix-bg');
            const ctx = canvas.getContext('2d');
            
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const fontSize = 14;
            const columns = Math.floor(canvas.width / fontSize);
            
            // Binary, hex, and other cyber characters
            const chars = "01アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヲン".split("");
            
            // An array to track the vertical position of each column
            const drops = [];
            for (let i = 0; i < columns; i++) {
                drops[i] = Math.floor(Math.random() * canvas.height);
            }
            
            // Colors for the matrix effect
            const colors = ['#00ff9d', '#00ddff', '#00ff9d', '#9dff00'];
            
            function draw() {
                // Set semi-transparent black background to create trail effect
                ctx.fillStyle = 'rgba(10, 18, 34, 0.05)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                for (let i = 0; i < drops.length; i++) {
                    // Choose a random character
                    const text = chars[Math.floor(Math.random() * chars.length)];
                    
                    // Choose a random color for the character
                    ctx.fillStyle = colors[Math.floor(Math.random() * colors.length)];
                    
                    // Draw the character
                    ctx.font = `${fontSize}px monospace`;
                    ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                    
                    // After drawing the character, increment y coordinate for next drawing cycle
                    if (drops[i] * fontSize > canvas.height && Math.random() > 0.99) {
                        drops[i] = 0;
                    }
                    
                    drops[i]++;
                }
                
                requestAnimationFrame(draw);
            }
            
            // Start the animation
            draw();
            
            // Resize handler
            window.addEventListener('resize', function() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
                
                // Update columns and drops arrays based on new width
                const newColumns = Math.floor(canvas.width / fontSize);
                
                if (newColumns > columns) {
                    // Add more columns
                    for (let i = columns; i < newColumns; i++) {
                        drops[i] = Math.floor(Math.random() * canvas.height);
                    }
                }
            });
        }
        
        // Initialize protocol chart
        function initProtocolChart() {
            const protocolCtx = document.getElementById('protocolChart');
            if (protocolCtx) {
                window.protocolChart = new Chart(protocolCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['TCP', 'UDP', 'ICMP'],
                        datasets: [{
                            data: [60, 30, 10],
                            backgroundColor: [
                                'rgba(35, 200, 255, 0.7)',
                                'rgba(255, 182, 41, 0.7)',
                                'rgba(255, 64, 129, 0.7)'
                            ],
                            borderColor: [
                                'rgba(35, 200, 255, 1)',
                                'rgba(255, 182, 41, 1)',
                                'rgba(255, 64, 129, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        cutout: '70%'
                    }
                });
            }
        }
        
        // Initialize packet types chart
        function initPacketTypesChart() {
            const packetTypesCtx = document.getElementById('packetTypesChart');
            if (packetTypesCtx) {
                window.packetTypesChart = new Chart(packetTypesCtx, {
                    type: 'bar',
                    data: {
                        labels: ['SYN', 'UDP', 'ICMP'],
                        datasets: [{
                            label: 'Packet Count',
                            data: [0, 0, 0],
                            backgroundColor: [
                                'rgba(35, 200, 255, 0.7)',
                                'rgba(255, 182, 41, 0.7)',
                                'rgba(255, 64, 129, 0.7)'
                            ],
                            borderColor: [
                                'rgba(35, 200, 255, 1)',
                                'rgba(255, 182, 41, 1)',
                                'rgba(255, 64, 129, 1)'
                            ],
                            borderWidth: 1,
                            borderRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.05)'
                                },
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                },
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
            }
        }
        
        // Initialize attack distribution chart
        function initAttackDistributionChart() {
            const attackDistributionCtx = document.getElementById('attackDistributionChart');
            if (attackDistributionCtx) {
                window.attackDistributionChart = new Chart(attackDistributionCtx, {
                    type: 'bar',
                    data: {
                        labels: ['SYN Flood', 'UDP Flood', 'HTTP Flood'],
                        datasets: [{
                            label: 'Attack Count',
                            data: [0, 0, 0],
                            backgroundColor: [
                                'rgba(255, 82, 82, 0.7)',
                                'rgba(255, 182, 41, 0.7)',
                                'rgba(35, 200, 255, 0.7)'
                            ],
                            borderColor: [
                                'rgba(255, 82, 82, 1)',
                                'rgba(255, 182, 41, 1)',
                                'rgba(35, 200, 255, 1)'
                            ],
                            borderWidth: 1,
                            borderRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.05)'
                                },
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                },
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
            }
        }
        
        // Initialize geo distribution chart
        function initGeoDistributionChart() {
            const geoDistributionCtx = document.getElementById('geoDistributionChart');
            if (geoDistributionCtx) {
                window.geoDistributionChart = new Chart(geoDistributionCtx, {
                    type: 'pie',
                    data: {
                        labels: ['North America', 'Europe', 'Asia', 'Other'],
                        datasets: [{
                            data: [45, 30, 20, 5],
                            backgroundColor: [
                                'rgba(35, 200, 255, 0.7)',
                                'rgba(28, 239, 175, 0.7)',
                                'rgba(255, 182, 41, 0.7)',
                                'rgba(255, 64, 129, 0.7)'
                            ],
                            borderColor: [
                                'rgba(35, 200, 255, 1)',
                                'rgba(28, 239, 175, 1)',
                                'rgba(255, 182, 41, 1)',
                                'rgba(255, 64, 129, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
            }
        }
        
        // Socket.IO event handlers
        socket.on('connect', function() {
            console.log('Connected to server');
            document.getElementById('status-indicator').classList.remove('warning', 'danger');
            document.getElementById('status-indicator').classList.add('active');
            document.getElementById('status-indicator').innerHTML = '<div class="w-2 h-2 rounded-full bg-success"></div><span>System Protected</span>';
        });
        
        socket.on('disconnect', function() {
            console.log('Disconnected from server');
            document.getElementById('status-indicator').classList.remove('active', 'warning');
            document.getElementById('status-indicator').classList.add('danger');
            document.getElementById('status-indicator').innerHTML = '<div class="w-2 h-2 rounded-full bg-danger"></div><span>Connection Lost</span>';
        });
        
        socket.on('system_stats', function(data) {
            // Update system stats on the dashboard
            document.getElementById('cpuUsage').textContent = `${Math.round(data.cpu)}%`;
            document.getElementById('cpuBar').style.width = `${data.cpu}%`;
            
            document.getElementById('memoryUsage').textContent = `${Math.round(data.memory)}%`;
            document.getElementById('memoryBar').style.width = `${data.memory}%`;
            
            // Calculate network throughput (simplified)
            const networkThroughput = ((data.network_sent + data.network_recv) / 1024 / 1024).toFixed(2);
            document.getElementById('networkUsage').textContent = `${networkThroughput} MB/s`;
            document.getElementById('networkBar').style.width = `${Math.min(networkThroughput * 5, 100)}%`;
            
            // Update estimated response time
            const responseTime = 50 + Math.random() * 20;
            document.getElementById('response-time').textContent = `${Math.round(responseTime)}ms`;
            document.getElementById('response-time-bar').style.width = `${Math.min(responseTime / 2, 100)}%`;
        });
        
        socket.on('traffic_stats', function(data) {
            // Update traffic stats
            totalPackets = data.total_packets;
            document.getElementById('packet-counter').textContent = `${totalPackets.toLocaleString()} packets analyzed`;
            document.getElementById('total-packets').textContent = totalPackets.toLocaleString();
            document.getElementById('suspicious-ips').textContent = data.suspicious_ips;
            document.getElementById('blocked-ips').textContent = data.blocked_ips;
            
            // Update packets per second
            if (data.packets_per_second !== undefined) {
                document.getElementById('packets-per-sec').textContent = data.packets_per_second;
                const ppsPercentage = Math.min((data.packets_per_second / 1000) * 100, 100);
                document.getElementById('packets-per-sec-bar').style.width = `${ppsPercentage}%`;
            }
            
            // Update SYN packets
            if (data.syn_packets !== undefined) {
                document.getElementById('syn-packets').textContent = data.syn_packets;
                const synPercentage = Math.min((data.syn_packets / 500) * 100, 100);
                document.getElementById('syn-packets-bar').style.width = `${synPercentage}%`;
                
                // Make confidence proportional to SYN packet rate
                const confidence = Math.min(95, data.syn_packets);
                updateConfidence(confidence);
                
                // Periodically simulate new attack detections
                if (Math.random() < 0.01 && data.syn_packets > 5) {  // 1% chance
                    const attackTypes = ["SYN Flood", "UDP Flood", "HTTP Flood", "ICMP Flood"];
                    const randomIPs = ["192.168.1.100", "10.0.0.15", "172.16.0.5", "192.168.1.5", "10.0.0.8"];
                    
                    const mockAttack = {
                        timestamp: Math.floor(Date.now()/1000),
                        source_ip: randomIPs[Math.floor(Math.random() * randomIPs.length)],
                        type: attackTypes[Math.floor(Math.random() * attackTypes.length)]
                    };
                    
                    addAttackToTable(mockAttack);
                }
            }
            
            // Calculate detection accuracy (normally this would come from the models)
            const accuracy = 95 + Math.random() * 3;
            document.getElementById('detection-accuracy').textContent = `${accuracy.toFixed(1)}%`;
            document.getElementById('detection-accuracy-bar').style.width = `${accuracy}%`;
            
            // Update traffic chart with new packet data
            updateTrafficChart(data);
            
            // Update throughput
            if (data.bytes_per_second !== undefined) {
                const throughputMB = (data.bytes_per_second / (1024 * 1024)).toFixed(2);
                document.getElementById('network-throughput').textContent = `${throughputMB} MB/s`;
                const throughputPercentage = Math.min((throughputMB / 10) * 100, 100);
                document.getElementById('network-throughput-bar').style.width = `${throughputPercentage}%`;
            }
            
            // Update protocol distribution chart
            if (data.protocol_distribution) {
                updateProtocolChart(data.protocol_distribution);
            }
            
            // Update mitigation effectiveness
            if (data.mitigation_effectiveness !== undefined) {
                document.getElementById('mitigationValue').textContent = `${Math.round(data.mitigation_effectiveness)}%`;
                document.getElementById('mitigationBar').style.width = `${data.mitigation_effectiveness}%`;
                document.getElementById('mitigation-score').textContent = `${Math.round(data.mitigation_effectiveness)}%`;
            }
            
            // Update firewall rules count
            if (data.firewall_rules !== undefined) {
                document.getElementById('firewall-rules').textContent = `${data.firewall_rules} active`;
            }
            
            // Update top source IPs if available
            if (data.top_source_ips && Object.keys(data.top_source_ips).length > 0) {
                updateTopSourceIPs(data.top_source_ips);
            }
            
            // Update protocol percentages
            if (data.protocol_distribution) {
                const total = data.protocol_distribution.tcp + data.protocol_distribution.udp + data.protocol_distribution.icmp;
                document.getElementById('tcp-percent').textContent = `${Math.round((data.protocol_distribution.tcp / total) * 100)}%`;
                document.getElementById('udp-percent').textContent = `${Math.round((data.protocol_distribution.udp / total) * 100)}%`;
                document.getElementById('icmp-percent').textContent = `${Math.round((data.protocol_distribution.icmp / total) * 100)}%`;
            }
            
            // Update packet types chart
            updatePacketTypesChart(data);
            
            // Update attack distribution chart
            updateAttackDistributionChart(data);
        });
        
        socket.on('attack_detected', function(data) {
            console.log('Attack detected:', data);
            attackCount++;
            
            // Show alert banner
            const alertBanner = document.getElementById('alertBanner');
            alertBanner.classList.remove('hidden');
            
            // Update alert details
            document.getElementById('alert-details').textContent = 
                `${data.type} attack detected from ${data.source_ip}`;
            
            // Add to attack table
            addAttackToTable(data);
            
            // Update confidence to high
            updateConfidence(95);
            
            // Auto-hide alert after 10 seconds
            setTimeout(() => {
                alertBanner.classList.add('hidden');
            }, 10000);
        });
        
        socket.on('connect_error', function(error) {
            console.log('Connection Error:', error);
            document.getElementById('status-indicator').classList.remove('active', 'warning');
            document.getElementById('status-indicator').classList.add('danger');
            document.getElementById('status-indicator').innerHTML = '<div class="w-2 h-2 rounded-full bg-danger"></div><span>Connection Error</span>';
        });
        
        // Helper functions
        function updateTrafficChart(data) {
            // Add new data points
            trafficData.datasets[0].data.push(data.packets_per_second || 0);
            trafficData.datasets[1].data.push(data.syn_packets || 0);
            
            // Remove oldest data points
            trafficData.datasets[0].data.shift();
            trafficData.datasets[1].data.shift();
            
            // Update timestamp labels
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', {hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit'});
            trafficData.labels.push(timeString);
            trafficData.labels.shift();
            
            // Update chart
            trafficChart.update();
        }
        
        function updateConfidence(value) {
            const confidenceBar = document.getElementById('confidenceBar');
            const confidenceValue = document.getElementById('confidenceValue');
            
            confidenceBar.style.width = `${value}%`;
            confidenceValue.textContent = `${Math.round(value)}%`;
            
            // Add pulsing effect when confidence is high
            if (value > 70) {
                confidenceBar.classList.add('pulse-animation');
            } else {
                confidenceBar.classList.remove('pulse-animation');
            }
        }
        
        function addAttackToTable(data) {
            const table = document.getElementById('attackTable');
            const row = document.createElement('tr');
            
            // Format timestamp
            const date = new Date(data.timestamp * 1000);
            const formattedTime = date.toLocaleTimeString('en-US', {hour12: false});
            
            row.innerHTML = `
                <td class="text-text-muted">${formattedTime}</td>
                <td class="font-mono">${data.source_ip}</td>
                <td class="text-danger">${data.type}</td>
            `;
            
            // Add new row at the top
            if (table.firstChild) {
                table.insertBefore(row, table.firstChild);
            } else {
                table.appendChild(row);
            }
            
            // Limit to 10 rows
            while (table.children.length > 10) {
                table.removeChild(table.lastChild);
            }
        }
        
        function updateTimestamps() {
            // This function updates any relative timestamps on the page
            const now = Date.now();
            const secondsElapsed = Math.floor((now - lastUpdate) / 1000);
            lastUpdate = now;
            
            // Update the packet counter (simulate continued counting even without updates)
            const packetCounter = document.getElementById('packet-counter');
            const currentCount = parseInt(totalPackets) + (secondsElapsed * 100); // Assume 100 packets per second
            packetCounter.textContent = `${currentCount.toLocaleString()} packets analyzed`;
        }
        
        // Update protocol chart
        function updateProtocolChart(data) {
            const protocolChart = window.protocolChart;
            if (protocolChart) {
                protocolChart.data.datasets[0].data = [
                    data.tcp || 60,
                    data.udp || 30,
                    data.icmp || 10
                ];
                protocolChart.update();
            }
        }
        
        // Update packet types chart
        function updatePacketTypesChart(data) {
            const packetTypesChart = window.packetTypesChart;
            if (packetTypesChart) {
                packetTypesChart.data.datasets[0].data = [
                    data.syn_packets || 0,
                    data.udp_packets || 0,
                    data.icmp_packets || 0
                ];
                packetTypesChart.update();
            }
        }
        
        // Update attack distribution chart
        function updateAttackDistributionChart(data) {
            const attackDistributionChart = window.attackDistributionChart;
            if (attackDistributionChart) {
                // If we have attack_types data, use it
                if (data.attack_types && Object.keys(data.attack_types).length > 0) {
                    // Get the top 3 attack types
                    const attackTypes = Object.entries(data.attack_types)
                        .sort((a, b) => b[1] - a[1])
                        .slice(0, 3);
                    
                    attackDistributionChart.data.labels = attackTypes.map(item => item[0]);
                    attackDistributionChart.data.datasets[0].data = attackTypes.map(item => item[1]);
                } else {
                    // Fallback to protocol-based attacks
                    attackDistributionChart.data.datasets[0].data = [
                        data.tcp_attacks || 0,
                        data.udp_attacks || 0,
                        data.icmp_attacks || 0
                    ];
                }
                attackDistributionChart.update();
            }
        }
        
        // Update top source IPs in the UI
        function updateTopSourceIPs(sourceIPs) {
            const topIPsElement = document.getElementById('top-ips');
            if (topIPsElement) {
                topIPsElement.innerHTML = '';
                
                // Create a sorted array of IPs
                const sortedIPs = Object.entries(sourceIPs)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 5);
                
                sortedIPs.forEach(([ip, count], index) => {
                    const ipItem = document.createElement('div');
                    ipItem.className = 'flex items-center justify-between p-2 rounded-lg bg-light-dark';
                    
                    const dangerClass = count > 10 ? 'text-danger' : 'text-text';
                    
                    ipItem.innerHTML = `
                        <div class="flex items-center gap-2">
                            <div class="text-sm w-5 text-text-muted">#${index + 1}</div>
                            <div class="font-mono text-sm ${dangerClass}">${ip}</div>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="text-sm text-text-muted">${count} pkts</span>
                            <div class="w-4 h-4 flex items-center justify-center">
                                ${count > 10 ? '<i class="fas fa-exclamation-triangle text-xs text-danger"></i>' : ''}
                            </div>
                        </div>
                    `;
                    topIPsElement.appendChild(ipItem);
                });
            }
        }

        // Function to initialize sample attack data
        function initSampleAttackData() {
            const table = document.getElementById('attackTable');
            if (!table) return;
            
            // Clear existing rows
            table.innerHTML = '';
            
            // Sample attack data
            const sampleAttacks = [
                { timestamp: Math.floor(Date.now()/1000) - 120, source_ip: '192.168.1.100', type: 'SYN Flood' },
                { timestamp: Math.floor(Date.now()/1000) - 350, source_ip: '10.0.0.15', type: 'UDP Flood' },
                { timestamp: Math.floor(Date.now()/1000) - 600, source_ip: '172.16.0.5', type: 'HTTP Flood' },
                { timestamp: Math.floor(Date.now()/1000) - 1800, source_ip: '192.168.1.5', type: 'ICMP Flood' }
            ];
            
            // Add sample attacks to table
            sampleAttacks.forEach(attack => {
                addAttackToTable(attack);
            });
        }
    </script>
</body>
</html>